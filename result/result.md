## **Multi-rate Soft Sensor Experiment**

### 1. **Setting 1 (*)**

+ **Hyper-parameters search space**

| Hyper-parameter Name |       Search Space       |
| :------------------: | :----------------------: |
|      multiplier      |       [15, 30, 60]       |
|        dim_h         |      [256, 128, 64]      |
|     weight_decay     | [0.1, 0.05, 0.01, 0.005] |
|      batch_size      |        [64, 128]         |

+ **Best hyper-parameters**

| Method  |  multiplier  |      dim_h      |     weight_decay      |   batch_size   |
| :-----: | :----------: | :-------------: | :-------------------: | :------------: |
|   MLP   | 30 / 30 / 30 |  64 / 256 / 64  |    0.1 / 0.1 / 0.1    |  64 / 64 / 64  |
|  I-MLP  | 15 / 15 / 15 | 256 / 256 / 256 | 0.005 / 0.005 / 0.005 |  64 / 64 / 64  |
|  L-MLP  | 60 / 15 / 15 | 64 / 128 / 128  |   0.1 / 0.1 / 0.05    |  64 / 64 / 64  |
|   RNN   | 60 / 60 / 30 | 128 / 64 / 128  |  0.05 / 0.01 / 0.005  |  64 / 64 / 64  |
|  I-RNN  | 30 / 60 / 60 | 128 / 128 / 256 |  0.01 / 0.005 / 0.01  | 128 / 128 / 64 |
| MCW-RNN | 15 / 60 / 15 | 128 / 128 / 64  |   0.1 / 0.1 / 0.05    | 64 / 64 / 128  |

+ **Performance**

|      [R2 (RMSE)]      | Train | Train | Test |          Test          |
| :---------------: | :-------------------------------: | :--: | :-------------------------------: | :-------------------------------: |
| **Method** |               **QV1**               | **QV2** | **QV1** | **QV2** |
| **Seed=123** |  |  |  |  |
|        MLP        |   92.95 (0.478)   | 96.58 (0.208) | 54.47 (1.094) |   87.41 (0.381)   |
| I-MLP | **99.32 (0.148)** | **99.86 (0.042)** | 51.52 (1.129) | 72.24 (0.566) |
|       L-MLP       |   93.62 (0.455)   | 97.32 (0.184) | 34.08 (1.317) |   84.28 (0.426)   |
|    RNN    |   65.45 (1.058)    | 90.59 (0.345) | 54.30 (1.096) |   88.04 (0.372)   |
| **I-RNN** | 98.94 (0.185) | 99.78 (0.053) | **75.57 (0.800)** | 70.44 (0.585) |
| **MCW-RNN (ours)** | 91.42 (0.527) | 96.73 (0.203) | 59.23 (1.036) | **90.95 (0.323)** |
| **Seed=1234** |  |  |  |  |
| MLP | 92.76 (0.484) | 96.46 (0.212) | 54.32 (1.096) | 86.40 (0.396) |
| **I-MLP** | **99.30 (0.150)** | **99.86 (0.043)** | **68.61 (0.909)** |   82.70 (0.447)   |
| L-MLP | 93.83 (0.447) | 97.57 (0.175) | 40.89 (1.247) | 85.24 (0.413) |
| RNN | 67.99 (1.018) | 93.94 (0.277) | 52.76 (1.115) | 84.68 (0.421) |
| I-RNN | 97.19 (0.302) | 96.59 (0.207) | 57.29 (1.058) | 84.62 (0.422) |
| **MCW-RNN (ours)** | 90.36 (0.559) | 96.70 (0.204) | 61.61 (1.005) | **90.78 (0.326)** |
| **Seed=12345** |  |  |  |  |
| MLP | 92.39 (0.496) | 96.43 (0.212) | 55.96 (1.076) | 86.91 (0.389) |
| I-MLP | **99.34 (0.146)** | **99.87 (0.041)** | 59.92 (1.027) | 70.34 (0.585) |
| L-MLP | 95.14 (0.397) | 98.01 (0.159) | 41.36 (1.242) | 85.20 (0.413) |
| RNN | 71.87 (0.955) | 89.82 (0.359) | 58.91 (1.040) | 86.52 (0.395) |
| I-RNN | 96.78 (0.323) | 98.99 (0.113) | 47.55 (1.172) | 81.63 (0.461) |
| **MCW-RNN (ours)** | 91.11 (0.536) | 97.01 (0.194) | **63.22 (0.984)** | **90.03 (0.339)** |

+ **Average Performance**

|       Method       |        QV1        |        QV2        |
| :----------------: | :---------------: | :---------------: |
|        MLP         |   54.92 (1.089)   |   86.91 (0.389)   |
|       I-MLP        |   60.02 (1.022)   |   75.09 (0.533)   |
|       L-MLP        |   38.78 (1.269)   |   84.91 (0.417)   |
|        RNN         |   55.32 (1.084)   |   86.41 (0.396)   |
|       I-RNN        |   60.14 (1.010)   |   78.90 (0.489)   |
| **MCW-RNN (ours)** | **61.35 (1.008)** | **90.59 (0.329)** |

------

### 2. **Setting 2**

+ **Hyper-parameters search space**

| Hyper-parameter Name |         Search Space          |
| :------------------: | :---------------------------: |
|      multiplier      |         [15, 30, 60]          |
|        dim_h         |        [256, 128, 64]         |
|          lr          |     [0.01, 0.001, 0.0001]     |
|     weight_decay     | [0.5, 0.1, 0.05, 0.01, 0.005] |
|      batch_size      |           [64, 128]           |

+ **Best hyper-parameters**

| Method  |  multiplier  |      dim_h      |          lr           |   weight_decay   |  batch_size   |
| :-----: | :----------: | :-------------: | :-------------------: | :--------------: | :-----------: |
|   MLP   | 60 / 60 / 60 | 256 / 128 / 256 |  0.01 / 0.01 / 0.01   | 0.5 / 0.1 / 0.5  | 128 / 64 / 64 |
|  L-MLP  | 30 / 15 / 60 | 256 / 64 / 256  |  0.001 / 0.01 / 0.01  | 0.5 / 0.5 / 0.05 | 64 / 64 / 64  |
|   RNN   | 15 / 15 / 15 | 128 / 256 / 256 | 0.001 / 0.001 / 0.001 | 0.5 / 0.5 / 0.5  | 64 / 64 / 64  |
| MCW-RNN | 15 / 15 / 60 | 256 / 64 / 128  |  0.01 / 0.01 / 0.001  | 0.5 / 0.5 / 0.5  | 64 / 64 / 128 |

+ **Performance**

|    [R2 (RMSE)]     |       Train       |       Train       |       Test        |       Test        |
| :----------------: | :---------------: | :---------------: | :---------------: | :---------------: |
|     **Method**     |      **QV1**      |      **QV2**      |      **QV1**      |      **QV2**      |
|    **Seed=123**    |                   |                   |                   |                   |
|        MLP         |   88.01 (0.623)   |   94.45 (0.265)   |   64.80 (0.962)   |   88.19 (0.369)   |
|       L-MLP        | **88.34 (0.614)** |   94.11 (0.273)   |   54.77 (1.091)   |   88.29 (0.368)   |
|      **RNN**       |   85.55 (0.684)   |   93.44 (0.288)   | **65.21 (0.957)** |   87.50 (0.380)   |
| **MCW-RNN (ours)** |   88.30 (0.616)   | **95.16 (0.247)** |   55.55 (1.081)   | **88.35 (0.367)** |
|   **Seed=1234**    |                   |                   |                   |                   |
|      **MLP**       | **90.82 (0.545)** | **96.41 (0.213)** |   62.77 (0.990)   | **89.59 (0.347)** |
|       L-MLP        |   88.10 (0.621)   |   93.87 (0.278)   |   56.83 (1.066)   |   88.95 (0.357)   |
|      **RNN**       |   85.63 (0.682)   |   93.53 (0.286)   | **65.47 (0.953)** |   87.41 (0.381)   |
|   MCW-RNN (ours)   |   88.61 (0.607)   |   94.02 (0.275)   |   54.98 (1.088)   |   88.63 (0.362)   |
|   **Seed=12345**   |                   |                   |                   |                   |
|      **MLP**       |   86.14 (0.670)   |   93.85 (0.279)   | **66.58 (0.938)** |   87.59 (0.379)   |
|       L-MLP        | **91.41 (0.528)** | **97.35 (0.183)** |   48.13 (1.168)   |   84.85 (0.418)   |
|        RNN         |   85.80 (0.678)   |   93.68 (0.282)   |   64.97 (0.960)   |   87.57 (0.379)   |
| **MCW-RNN (ours)** |   88.85 (0.601)   |   94.64 (0.260)   |   53.90 (1.101)   | **89.20 (0.353)** |

------

> **Note:**
>
> + MLP——只使用少量包含完整变量的样本建立MLP
> + I-MLP——使用三次样条插值填补后建立MLP
> + L-MLP——使用lifting技巧将过程变量堆叠后建立MLP
> + RNN——将缺少的变量用0替代后建立RNN
> + I-RNN——使用三次样条插值填补后建立RNN
> + MCW-RNN——根据每一时刻所包含变量对隐层特征进行周期更新（所提方法）